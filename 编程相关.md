### 动态库和静态库

#### 静态库

**静态库**是编译时生成的一个文件。里面的代码是编译好的二进制目标文件，可以提供头文件给其他程序使用。在程序编译的最后一个阶段也就是链接阶段，

**如何被加载：**提供的静态库会被打包到可执行程序中。当可执行程序被执行，静态库中的代码也会一并被加载到内存中。

#### 动态库

**动态库**动态链接库是程序运行时加载的库，当动态链接库正确部署之后，运行的多个程序可以使用同一个加载到内存中的动态库，因此在 Linux 中动态链接库也可称之为共享库。动态链接库是程序运行时加载的库，当动态链接库正确部署之后，运行的多个程序可以使用同一个加载到内存中的动态库，因此在 Linux 中动态链接库也可称之为共享库。

**如何被加载：**

- 在程序编译的最后一个阶段也就是链接阶段：

  - 在 gcc 命令中虽然指定了库路径 (使用参数 -L ), 但是这个路径并没有记录到可执行程序中，只是检查了这个路径下的库文件是否存在。
  - 同样对应的动态库文件也没有被打包到可执行程序中，只是在可执行程序中记录了库的名字。
- 可执行程序被执行起来之后:
  - 程序执行的时候会先检测需要的动态库是否可以被加载，加载不到就会提示上边的错误信息
  - 当动态库中的函数在程序中被调用了, 这个时候动态库才加载到内存，如果不被调用就不加载



#### 动态链接器

动态链接器是一个独立于应用程序的进程，属于操作系统。动态链接器是如何搜索某一个动态库的呢，在它内部有一个默认的搜索顺序。需要将动态库的路径放到对应的环境变量或者系统配置文件中，同样也可以将动态库拷贝到系统库目录（或者是将动态库的软链接文件放到这些系统库目录中）。



#### 优缺点

**静态库：**优点：加载速度快。缺点：相同库文件在内存中被加载多份；库更新需要重新编译可执行程序

**动态库：**优点：升级简单，不用重新编译可执行文件。多个程序只需要使用一份内存